$(document).on('turbolinks:load', function(){

  //Alerts and notice fade out
  setTimeout(function(){
  $('.alert').fadeOut();
}, 3000);
  setTimeout(function(){
  $('.notice').fadeOut();
}, 3000);

  //Menu
  $('.open-menu').on('click', function() {
    //Open overlay menu and hide search form
    $('.overlay').addClass('open');
    $("#searchform").css("visibility", "hidden");
    //Replace globe-icon with x-icon
    $( ".icon-container" ).html( '<%= image_tag "close.png", class: "close-menu" %>');
    //Block scrolling
    $('html, body').css({
    overflow: 'hidden',
    height: '100%'
    });
  });

  $('.close-menu').on('click', function() {
    //Close overlay menu and restore search form
    $('.overlay').removeClass('open');
    $("#searchform").css("visibility", "visible");
    //Restore globe-icon
    $( ".icon-container" ).html('<%= image_tag "open.png", class: "open-menu" %>');
    //Restore scrolling
    $('html, body').css({
    overflow: 'auto',
    height: 'auto'
   });
  });

  $('.logo').on('click', function() {
    //Restore scrolling
    $('html, body').css({
    overflow: 'auto',
    height: 'auto'
   });
  });
  
  $('.overlay-menu').on('click', function() {
    //Restore scrolling
    $('html, body').css({
    overflow: 'auto',
    height: 'auto'
   });
  });

  // Timed text swap 
  var cnt=0, texts=[];
    $(".title2-fill").each(function() {
      texts[cnt++]=$(this).text();
    });
    function slide() {
      if (cnt>=texts.length) cnt=0;
      $('#title2-filled').html(texts[cnt++]);
      $('#title2-filled')
        .fadeIn('slow').animate({opacity: 1.0}, 1900).fadeOut('slow', 
         function() {
           return slide()
         }
      );      
    }      
    slide()                    
});
